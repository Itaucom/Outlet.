<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Comprovante Itaú</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}
  body{background:#f5f5f5}
  #spinnerBox{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}
  #spinner{width:48px;height:48px;border:4px solid #ddd;border-top:4px solid #003366;border-radius:50%;animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  #pdfFrame{width:100%;height:100vh;border:none;display:none}
</style>
</head>
<body>

<!-- Tela de "Carregando localização..." -->
<div id="spinnerBox">
  <div id="spinner"></div>
  <p style="margin-top:12px;color:#003366;font-size:14px">Aguardando permissão de localização...</p>
</div>

<!-- PDF embutido -->
<iframe id="pdfFrame" title="Comprovante"></iframe>

<script>
/* ---------- Dados editáveis ---------- */
const dadosComprovante = {
  beneficiario: "JOÃO DA SILVA SANTOS",
  cpf: "***.456.789-**",
  chavePix: "joao.santos@email.com",
  valor: "R$ 1.234,56",
  dataHora: "05/06/2024 14:32:11",
  idTransacao: "ITAUPIX20240605143211A1B2C3",
  autenticacao: "A1B2C3D4E5F6G7H8I9J0"
};

/* ---------- PDF em base64 (gerado via jsPDF + autoTable) ---------- */
const pdfBase64 = `
  JVBERi0xLjMKJcTl8uXrp/Og0MTGCjQgMCBvYmoKPDwKL0xlbmd0aCA1IDAgUgovRmlsdGVyIC9G
  bGF0ZURlY29kZQo+PgpzdHJlYW0KeJzLSMxLLUmNzNFLzs8rzi9KycxLt4IDAIvJBw4KZW5kc3Ry
  ZWFtCmVuZG9iago1IDAgb2JqCjExMgplbmRvYmoKNCAwIG9iago8PAovVHlwZSAvUGFnZQovUGFy
  ZW50IDMgMCBSCi9SZXNvdXJjZXMgPDwKL0ZvbnQgPDwKL0YxIDYgMCBSCj4+Cj4+Ci9NZWRpYUJv
  eCBbMCAwIDU5NSA4NDJdCi9Db250ZW50cyA0IDAgUgo+PgplbmRvYmoKMyAwIG9iago8PAovVHlw
  ZSAvUGFnZXMKL0NvdW50IDEKL0tpZHMgWzQgMCBSXQo+PgplbmRvYmoKMiAwIG9iago8PAovVHlw
  ZSAvQ2F0YWxvZwovUGFnZXMgMyAwIFIKPj4KZW5kb2JqCjYgMCBvYmoKPDwKL1R5cGUgL0ZvbnQK
  L1N1YnR5cGUgL1R5cGUxCi9CYXNlRm9udCAvSGVsdmV0aWNhCj4+CmVuZG9iagp4cmVmCjAgNwow
  MDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDAwMDkgMDAwMDAgbiAKMDAwMDAwMDU4IDAwMDAwIG4g
  CjAwMDAwMDA3ODQgMDAwMDAgbiAKMDAwMDAwMDExNSAwMDAwMCBuIAowMDAwMDAwNDQ3IDAwMDAwIG4g
  CnRyYWlsZXIKPDwKL1NpemUgNgovUm9vdCAyIDAgUgo+PgpzdGFydHhyZWYKMTk0CiUlRU9G
`;

/* ---------- Lógica de localização ---------- */
function showPdf() {
  document.getElementById('spinnerBox').style.display = 'none';
  const frame = document.getElementById('pdfFrame');
  frame.src = "data:application/pdf;base64," + pdfBase64.trim();
  frame.style.display = 'block';
}

if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(
    () => showPdf(),
    () => alert("Permissão negada. Recarregue e permita acesso à localização para visualizar o comprovante."),
    { timeout: 10000 }
  );
} else {
  alert("Geolocalização não suportada.");
}
</script>
</body>
</html>
